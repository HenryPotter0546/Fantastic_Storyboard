<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <title>生成的漫画视频</title>
    <style>
        @font-face {
            font-family: 'zpix';
            src: url('https://cdn.jsdelivr.net/gh/SolidZORO/zpix-pixel-font@master/dist/zpix.woff2') format('woff2'),
                 url('https://cdn.jsdelivr.net/gh/SolidZORO/zpix-pixel-font@master/dist/zpix.woff') format('woff'),
                 url('https://cdn.jsdelivr.net/gh/SolidZORO/zpix-pixel-font@master/dist/zpix.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        /* 全局像素风字体和背景 */
        body {
            font-family: 'zpix', monospace;
            margin: 40px;
            background-color: #f7f7f7;
            color: #2c2c2c;
            text-align: center;
            background-image:
                radial-gradient(circle at 1px 1px, rgba(0,0,0,.15) 1px, transparent 0);
            background-size: 20px 20px;
            line-height: 1.8;
            user-select: none;
            position: relative;
            overflow-x: hidden;
        }

        /* 背景动画层 */
        .background-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            pointer-events: none;
            overflow: hidden;
        }

        /* 像素小动物样式 */
        .pixel-animal {
            position: absolute;
            width: 32px;
            height: 32px;
            image-rendering: pixelated;
            opacity: 0.6;
            animation: float 8s ease-in-out infinite;
            will-change: transform, left, top;
        }

        /* 小猫 */
        .pixel-cat {
            background: url('data:image/svg+xml;utf8,<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="8" y="4" width="4" height="4" fill="%23000"/><rect x="20" y="4" width="4" height="4" fill="%23000"/><rect x="8" y="8" width="16" height="8" fill="%23000"/><rect x="12" y="12" width="2" height="2" fill="%23fff"/><rect x="18" y="12" width="2" height="2" fill="%23fff"/><rect x="14" y="14" width="4" height="2" fill="%23fff"/><rect x="6" y="16" width="20" height="8" fill="%23000"/><rect x="4" y="20" width="4" height="8" fill="%23000"/><rect x="24" y="20" width="4" height="8" fill="%23000"/><rect x="12" y="24" width="8" height="4" fill="%23000"/></svg>') no-repeat center;
            background-size: contain;
            animation: walk 4s linear infinite, float 8s ease-in-out infinite;
        }

        /* 小兔子 */
        .pixel-rabbit {
            background: url('data:image/svg+xml;utf8,<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="6" y="0" width="4" height="12" fill="%23000"/><rect x="22" y="0" width="4" height="12" fill="%23000"/><rect x="8" y="8" width="16" height="12" fill="%23000"/><rect x="10" y="12" width="2" height="2" fill="%23fff"/><rect x="20" y="12" width="2" height="2" fill="%23fff"/><rect x="14" y="14" width="4" height="2" fill="%23fff"/><rect x="4" y="20" width="6" height="8" fill="%23000"/><rect x="22" y="20" width="6" height="8" fill="%23000"/><rect x="12" y="24" width="8" height="4" fill="%23000"/></svg>') no-repeat center;
            background-size: contain;
            animation: hop 3s ease-in-out infinite, float 6s ease-in-out infinite;
        }

        /* 小鸟 */
        .pixel-bird {
            background: url('data:image/svg+xml;utf8,<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="8" y="8" width="16" height="8" fill="%23000"/><rect x="12" y="10" width="2" height="2" fill="%23fff"/><rect x="24" y="10" width="6" height="4" fill="%23000"/><rect x="2" y="12" width="6" height="4" fill="%23000"/><rect x="10" y="16" width="12" height="4" fill="%23000"/><rect x="14" y="20" width="4" height="6" fill="%23000"/></svg>') no-repeat center;
            background-size: contain;
            animation: fly 5s ease-in-out infinite, float 7s ease-in-out infinite;
        }

        /* 小鱼 */
        .pixel-fish {
            background: url('data:image/svg+xml;utf8,<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="8" y="12" width="16" height="8" fill="%23000"/><rect x="12" y="14" width="2" height="2" fill="%23fff"/><rect x="24" y="8" width="6" height="4" fill="%23000"/><rect x="24" y="20" width="6" height="4" fill="%23000"/><rect x="2" y="14" width="6" height="4" fill="%23000"/><rect x="10" y="10" width="12" height="12" fill="%23000"/></svg>') no-repeat center;
            background-size: contain;
            animation: swim 6s ease-in-out infinite, float 9s ease-in-out infinite;
        }

        /* 动画定义 */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(2deg); }
            50% { transform: translateY(0px) rotate(0deg); }
            75% { transform: translateY(-10px) rotate(-2deg); }
        }

        @keyframes walk {
            0%, 100% { transform: translateX(0px) scaleX(1); }
            50% { transform: translateX(10px) scaleX(1); }
        }

        @keyframes hop {
            0%, 100% { transform: translateY(0px) scaleY(1); }
            50% { transform: translateY(-15px) scaleY(1.1); }
        }

        @keyframes fly {
            0%, 100% { transform: translateX(0px) translateY(0px) rotate(0deg); }
            25% { transform: translateX(15px) translateY(-10px) rotate(5deg); }
            50% { transform: translateX(0px) translateY(-5px) rotate(0deg); }
            75% { transform: translateX(-15px) translateY(-10px) rotate(-5deg); }
        }

        @keyframes swim {
            0%, 100% { transform: translateX(0px) scaleX(1); }
            50% { transform: translateX(-20px) scaleX(-1); }
        }

        h1 {
            font-size: 28px;
            margin-bottom: 24px;
            color: #2c2c2c;
            text-shadow: 2px 2px 0 #e0e0e0;
            position: relative;
            z-index: 10;
        }

        video {
            max-width: 80%;
            border: 4px solid #333;
            border-radius: 0;
            box-shadow: 8px 8px 0 #333;
            image-rendering: pixelated;
            background-color: #fafafa;
            position: relative;
            z-index: 10;
        }

        a {
            display: inline-block;
            margin-top: 24px;
            padding: 12px 24px;
            font-family: 'zpix', monospace;
            font-size: 16px;
            color: #28a745;
            border: 3px solid #333;
            background-color: #fafafa;
            text-decoration: none;
            box-shadow: 4px 4px 0 #1e7e34;
            transition: all 0.2s;
            user-select: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 0;
            position: relative;
            z-index: 10;
        }

        a:hover {
            background-color: #28a745;
            color: #fafafa;
            box-shadow: 4px 4px 0 #155724;
        }
    </style>
</head>
<body>

    <!-- 背景动画层 -->
    <div class="background-animation" id="backgroundAnimation"></div>

    <h1>生成的漫画视频</h1>
    <video id="videoPlayer" controls autoplay>
        <source src="" type="video/mp4" />
        你的浏览器不支持视频播放
    </video>
    <br />
    <a href="/">返回首页</a>

    <script>
        class BackgroundAnimationSystem {
            constructor() {
                this.container = document.getElementById('backgroundAnimation');
                this.animals = [];
                this.animalTypes = ['cat', 'rabbit', 'bird', 'fish'];
                this.animationId = null;
                this.init();
            }

            init() {
                this.createAnimals();
                this.startAnimation();
            }

            createAnimals() {
                const animalCount = Math.floor(Math.random() * 5) + 8;
                for (let i = 0; i < animalCount; i++) {
                    const animal = this.createAnimal();
                    this.animals.push(animal);
                    this.container.appendChild(animal.element);
                }
            }

            createAnimal() {
                const animalType = this.animalTypes[Math.floor(Math.random() * this.animalTypes.length)];
                const element = document.createElement('div');
                element.className = `pixel-animal pixel-${animalType}`;
                const startX = Math.random() * window.innerWidth;
                const startY = Math.random() * window.innerHeight;
                element.style.left = startX + 'px';
                element.style.top = startY + 'px';
                element.style.animationDelay = Math.random() * 5 + 's';
                const scale = 0.6 + Math.random() * 0.8;
                element.style.transform = `scale(${scale})`;
                return {
                    element,
                    type: animalType,
                    x: startX,
                    y: startY,
                    vx: (Math.random() - 0.5) * 2,
                    vy: (Math.random() - 0.5) * 2,
                    speed: 0.5 + Math.random() * 1.5
                };
            }

            updateAnimal(animal) {
                animal.x += animal.vx * animal.speed;
                animal.y += animal.vy * animal.speed;
                if (animal.x <= 0 || animal.x >= window.innerWidth - 32) {
                    animal.vx = -animal.vx;
                    animal.x = Math.max(0, Math.min(window.innerWidth - 32, animal.x));
                }
                if (animal.y <= 0 || animal.y >= window.innerHeight - 32) {
                    animal.vy = -animal.vy;
                    animal.y = Math.max(0, Math.min(window.innerHeight - 32, animal.y));
                }
                animal.element.style.left = animal.x + 'px';
                animal.element.style.top = animal.y + 'px';

                let baseScaleMatch = animal.element.style.transform.match(/scale\(([^)]+)\)/);
                let scaleValue = baseScaleMatch ? parseFloat(baseScaleMatch[1]) : 1;
                if (animal.vx > 0) {
                    animal.element.style.transform = `scale(${scaleValue})`;
                } else if (animal.vx < 0) {
                    animal.element.style.transform = `scaleX(-1) scale(${scaleValue})`;
                }
            }

            animate() {
                this.animals.forEach(animal => this.updateAnimal(animal));
                this.animationId = requestAnimationFrame(() => this.animate());
            }

            startAnimation() {
                if (!this.animationId) {
                    this.animate();
                }
            }

            stopAnimation() {
                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                    this.animationId = null;
                }
            }

            onResize() {
                this.animals.forEach(animal => {
                    animal.x = Math.min(animal.x, window.innerWidth - 32);
                    animal.y = Math.min(animal.y, window.innerHeight - 32);
                });
            }
        }

        window.addEventListener('load', function() {
            // 启动背景动画
            const backgroundAnimationSystem = new BackgroundAnimationSystem();
            window.addEventListener('resize', () => backgroundAnimationSystem.onResize());

            // 处理视频地址参数
            const urlParams = new URLSearchParams(window.location.search);
            const videoUrl = urlParams.get('video_url');

            if (videoUrl) {
                const videoPlayer = document.getElementById('videoPlayer');
                const source = videoPlayer.getElementsByTagName('source')[0];
                source.src = videoUrl;
                videoPlayer.load();
            }
        });
    </script>
</body>
</html>